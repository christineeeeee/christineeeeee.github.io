<!DOCTYPE html>
<html lang="en">

  <head>
    <meta charset="utf-8">
    <meta name="theme-color" content="#999686">
    <meta name="viewport" content="initial-scale=1, viewport-fit=cover, width=device-width"></meta>
    <meta name="apple-mobile-web-app-capable" content="yes"></meta>
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"></meta>

    <meta name="author" content="Christine">
    
    

    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Twitter Sentiment Strategy"/>
<meta name="twitter:description" content="1. Introduction This is an exploratory research trying to implement a sentiment analysis mechanism of ten of the most discussed techonology stocks in the market nowadays. By collecting people&rsquo;s discussions about the stocks on twitter, we used NLP (Natural language processing) to analyze people&rsquo;s reactions and guesses of the market and got a score which indicates people&rsquo;s positive or negative attitudes towards those certain stocks. Based on the daily scores we get, we adjusted our positions automatically."/>

    <meta property="og:title" content="Twitter Sentiment Strategy" />
<meta property="og:description" content="1. Introduction This is an exploratory research trying to implement a sentiment analysis mechanism of ten of the most discussed techonology stocks in the market nowadays. By collecting people&rsquo;s discussions about the stocks on twitter, we used NLP (Natural language processing) to analyze people&rsquo;s reactions and guesses of the market and got a score which indicates people&rsquo;s positive or negative attitudes towards those certain stocks. Based on the daily scores we get, we adjusted our positions automatically." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://christineeeeee.com/posts/twitter_sentiment/" />
<meta property="article:published_time" content="2020-06-05T18:08:00+00:00" />
<meta property="article:modified_time" content="2020-06-05T18:08:00+00:00" />


    
      <base href="https://christineeeeee.com/posts/twitter_sentiment/">
    
    <title>
  Twitter Sentiment Strategy · Christine&#39;s Shattered Life
</title>

    
      <link rel="canonical" href="https://christineeeeee.com/posts/twitter_sentiment/">
    

    <link href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather:300,700%7CSource+Code+Pro:400,700" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.11.2/css/all.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" integrity="sha256-l85OmPOjvil/SOvVt3HnSSjzF1TUMyT9eV0c2BzEGzU=" crossorigin="anonymous" />

    <link rel="stylesheet" href="/css/fonts.css" />

    
      
      
      <link rel="stylesheet" href="/css/coder.min.c6a6f7e4e5b9eae62968f9dee6cad8903a7a12c11df9305249ee05c53679cafe.css" integrity="sha256-xqb35OW56uYpaPne5srYkDp6EsEd&#43;TBSSe4FxTZ5yv4=" crossorigin="anonymous" media="screen" />
    

    

    

    
      <link rel="stylesheet" href="/css/custom.css" />
    

    

    

    <link rel="icon" type="image/png" href="https://christineeeeee.com/images/avatar.jpg" sizes="32x32">
    <link rel="icon" type="image/png" href="https://christineeeeee.com/images/avatar.jpg" sizes="16x16">

    <meta name="generator" content="Hugo 0.63.1" />

  </head>

  
  
  <body class="colorscheme-light">
    <main class="wrapper">
      <nav class="navigation">
  <section class="container">
    <a class="navigation-title" href="/">
      Christine&#39;s Shattered Life
    </a>
    
    <input type="checkbox" id="menu-toggle" />
    <label class="menu-button float-right" for="menu-toggle"><i class="fas fa-bars"></i></label>
    <ul class="navigation-list">
      
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://christineeeeee.com/posts/">Posts</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://christineeeeee.com/pieces/">Pieces</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://christineeeeee.com/newsletter/">Newsletter</a>
          </li>
        
          <li class="navigation-item">
            <a class="navigation-link" href="https://christineeeeee.com/about/">About</a>
          </li>
        
      
      
    </ul>
    
  </section>
</nav>


      <div class="content">
        
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">Twitter Sentiment Strategy</h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fas fa-calendar"></i>
              <time datetime='2020-06-05T18:08:00Z'>
                June 5, 2020
              </time>
            </span>
            <span class="reading-time">
              <i class="fas fa-clock"></i>
              19-minute read
            </span>
          </div>
          
          <div class="tags">
  <i class="fas fa-tag"></i>
    <a href="/tags/python/">Python</a>
      <span class="separator">•</span>
    <a href="/tags/strategy/">Strategy</a></div>

        </div>
      </header>

      <div>
        
        <h2 id="1-introduction">1. Introduction</h2>
<p>This is an exploratory research trying to implement a sentiment analysis mechanism of ten of the most discussed techonology stocks in the market nowadays. By collecting people&rsquo;s discussions about the stocks on twitter, we used NLP (Natural language processing) to analyze people&rsquo;s reactions and guesses of the market and got a score which indicates people&rsquo;s positive or negative attitudes towards those certain stocks. Based on the daily scores we get, we adjusted our positions automatically. The strategy is implemented with backtesting period from Jan. 1st 2020 to May 31th 2020. It yields a remarkable Sharpe Ratio of 3.01, which proves this is a pretty decent and tradable signal existing in the market.</p>
<h2 id="2-data-preparation">2. Data Preparation</h2>
<p>In this section, we&rsquo;re going to discuss the source of our data and how we prepare for the sentiment strategy.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">import</span> <span style="color:#111">os</span>
<span style="color:#f92672">import</span> <span style="color:#111">twint</span>
<span style="color:#f92672">import</span> <span style="color:#111">pandas</span> <span style="color:#f92672">as</span> <span style="color:#111">pd</span>
<span style="color:#f92672">import</span> <span style="color:#111">nest_asyncio</span>
<span style="color:#f92672">import</span> <span style="color:#111">flair</span>
<span style="color:#f92672">import</span> <span style="color:#111">warnings</span>
<span style="color:#f92672">from</span> <span style="color:#111">tqdm.auto</span> <span style="color:#f92672">import</span> <span style="color:#111">tqdm</span>
<span style="color:#f92672">import</span> <span style="color:#111">re</span>
<span style="color:#f92672">import</span> <span style="color:#111">nltk</span>
<span style="color:#f92672">from</span> <span style="color:#111">nltk</span> <span style="color:#f92672">import</span> <span style="color:#111">word_tokenize</span>
<span style="color:#f92672">from</span> <span style="color:#111">nltk.corpus</span> <span style="color:#f92672">import</span> <span style="color:#111">stopwords</span>
<span style="color:#f92672">from</span> <span style="color:#111">nltk.stem.wordnet</span> <span style="color:#f92672">import</span> <span style="color:#111">WordNetLemmatizer</span>
<span style="color:#f92672">from</span> <span style="color:#111">nltk.corpus</span> <span style="color:#f92672">import</span> <span style="color:#111">wordnet</span>
<span style="color:#f92672">from</span> <span style="color:#111">wordcloud</span> <span style="color:#f92672">import</span> <span style="color:#111">WordCloud</span>
<span style="color:#f92672">import</span> <span style="color:#111">matplotlib.pyplot</span> <span style="color:#f92672">as</span> <span style="color:#111">plt</span>
<span style="color:#f92672">import</span> <span style="color:#111">seaborn</span> <span style="color:#f92672">as</span> <span style="color:#111">sns</span>
<span style="color:#f92672">from</span> <span style="color:#111">collections</span> <span style="color:#f92672">import</span> <span style="color:#111">Counter</span>
<span style="color:#f92672">import</span> <span style="color:#111">datetime</span>
<span style="color:#f92672">import</span> <span style="color:#111">quandl</span>
<span style="color:#f92672">import</span> <span style="color:#111">pickle</span>

<span style="color:#111">nest_asyncio</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">warnings</span><span style="color:#f92672">.</span><span style="color:#111">filterwarnings</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">ignore</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">rcParams</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">figure.figsize</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span><span style="color:#ae81ff">20</span><span style="color:#111">,</span> <span style="color:#ae81ff">5</span><span style="color:#111">)</span>
<span style="color:#111">quandl</span><span style="color:#f92672">.</span><span style="color:#111">ApiConfig</span><span style="color:#f92672">.</span><span style="color:#111">api_key</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">yFs2mPKxvfCC26C4vG3K</span><span style="color:#d88200">&#39;</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="a-data-crawling">A. Data Crawling</h3>
<h4 id="a-collect-related-tweets">a. Collect related tweets</h4>
<p>We chose ten of the most discussed technology stocks ( <strong>Tesla(tsla), Netflix(nflx), Microsoft(msft), Zoom(zm), Apple( aapl), Amazon(amzn), Twitter(twtr), Google(googl), Sony(sne), Nvidia(nvda)</strong> ) in the market nowadays. Technology&rsquo;s changing the world, especially during the COVID19 quarantine. Unlike traditional retail business, social media and online shopping companies like Twitter and Amazon are still growing and making profits. Companies like Zoom doubled its market value. No matter what makes people excited, Tesla and its leader Elon Musk always interests people a lot and with the success of the Space X mission several days ago, it is one of the most heated topics on social media.</p>
<p>We want to know how the market changes with people&rsquo;s attitudes and reactions towards stocks and investment, so we used Twitter, one of the most popular social media around the world, to collect people&rsquo;s thoughts about the stocks in our portfolio. We used those companies&rsquo; names and their stock names as our keywords to crawl tweets from twitter.</p>
<p>To get the complete tweets in the time period we chose, we used a package named <strong>twint</strong>. It&rsquo;s an advanced Twitter scaping tool. By implementing twint, we could get every tweet about our stocks during the backtest period. Twint has a lot of interesting functions to help you scape every information you need from Twitter.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">def</span> <span style="color:#75af00">get_tweets</span><span style="color:#111">(</span><span style="color:#111">start_date</span><span style="color:#111">,</span> <span style="color:#111">end_date</span><span style="color:#111">,</span> <span style="color:#111">company_name</span><span style="color:#111">,</span> <span style="color:#111">ticker</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">c</span> <span style="color:#f92672">=</span> <span style="color:#111">twint</span><span style="color:#f92672">.</span><span style="color:#111">Config</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Search</span> <span style="color:#f92672">=</span> <span style="color:#111">company_name</span><span style="color:#111">,</span> <span style="color:#111">ticker</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Since</span> <span style="color:#f92672">=</span> <span style="color:#111">start_date</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Until</span> <span style="color:#f92672">=</span> <span style="color:#111">end_date</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Store_csv</span> <span style="color:#f92672">=</span> <span style="color:#111">True</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Lang</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">en</span><span style="color:#d88200">&#39;</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Count</span> <span style="color:#f92672">=</span> <span style="color:#111">True</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Hide_output</span> <span style="color:#f92672">=</span> <span style="color:#111">True</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Format</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Tweet id: {id} | Date: {date} | Time: {time} | Tweet: {tweet}</span><span style="color:#d88200">&#39;</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Custom</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">id</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">date</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">time</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span>
    <span style="color:#111">c</span><span style="color:#f92672">.</span><span style="color:#111">Output</span> <span style="color:#f92672">=</span> <span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">{company_name}_tweets_202001.csv</span><span style="color:#d88200">&#39;</span>
    <span style="color:#111">twint</span><span style="color:#f92672">.</span><span style="color:#111">run</span><span style="color:#f92672">.</span><span style="color:#111">Search</span><span style="color:#111">(</span><span style="color:#111">c</span><span style="color:#111">)</span>

<span style="color:#111">start_date</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">2020-01-01</span><span style="color:#d88200">&#39;</span>
<span style="color:#111">end_date</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">2020-05-31</span><span style="color:#d88200">&#39;</span><span style="color:#111">hugo</span>
<span style="color:#111">stock_pool</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tesla</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tsla</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">netflix</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">nflx</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">microsoft</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">msft</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">zoom</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">zm</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">apple</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">aapl</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span>
              <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">amazon</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">amzn</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">twitter</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">twtr</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">google</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">googl</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">sony</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">sne</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">nvidia</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">nvda</span><span style="color:#d88200">&#39;</span><span style="color:#111">}</span>

<span style="color:#00a8c8">for</span> <span style="color:#111">k</span><span style="color:#111">,</span> <span style="color:#111">v</span> <span style="color:#f92672">in</span> <span style="color:#111">tqdm</span><span style="color:#111">(</span><span style="color:#111">stock_pool</span><span style="color:#f92672">.</span><span style="color:#111">items</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">if</span> <span style="color:#111">os</span><span style="color:#f92672">.</span><span style="color:#111">path</span><span style="color:#f92672">.</span><span style="color:#111">isfile</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/tweets_{k}_202001.csv</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
        <span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">{k} finished</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">else</span><span style="color:#111">:</span>  
        <span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">downloading {k}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
        <span style="color:#111">get_tweets</span><span style="color:#111">(</span><span style="color:#111">start_date</span><span style="color:#111">,</span> <span style="color:#111">end_date</span><span style="color:#111">,</span> <span style="color:#111">k</span><span style="color:#111">,</span> <span style="color:#111">v</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="b-collect-eod">b. Collect EOD</h4>
<p>From Quandl, we also collected the daily Adjusted Close Price of the stocks in our portfolio.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">def</span> <span style="color:#75af00">get_eod</span><span style="color:#111">(</span><span style="color:#111">tic</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">quandl</span><span style="color:#f92672">.</span><span style="color:#111">get</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">EOD/{tic}</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">start_date</span><span style="color:#f92672">=</span><span style="color:#111">start_date</span><span style="color:#111">,</span> <span style="color:#111">end_date</span><span style="color:#f92672">=</span><span style="color:#111">end_date</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">Adj_Close</span>

<span style="color:#00a8c8">if</span> <span style="color:#111">os</span><span style="color:#f92672">.</span><span style="color:#111">path</span><span style="color:#f92672">.</span><span style="color:#111">isfile</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/EOD.pkl</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">with</span> <span style="color:#111">open</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/EOD.pkl</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">rb</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span> <span style="color:#00a8c8">as</span> <span style="color:#111">f</span><span style="color:#111">:</span>
        <span style="color:#111">EOD</span> <span style="color:#f92672">=</span> <span style="color:#111">pickle</span><span style="color:#f92672">.</span><span style="color:#111">load</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#111">)</span>
<span style="color:#00a8c8">else</span><span style="color:#111">:</span>
    <span style="color:#111">EOD</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#111">}</span>
    <span style="color:#00a8c8">for</span> <span style="color:#111">k</span><span style="color:#111">,</span> <span style="color:#111">v</span> <span style="color:#f92672">in</span> <span style="color:#111">tqdm</span><span style="color:#111">(</span><span style="color:#111">stock_pool</span><span style="color:#f92672">.</span><span style="color:#111">items</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
        <span style="color:#111">EOD</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">get_eod</span><span style="color:#111">(</span><span style="color:#111">v</span><span style="color:#f92672">.</span><span style="color:#111">upper</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">with</span> <span style="color:#111">open</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/EOD.pkl</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">wb</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span> <span style="color:#00a8c8">as</span> <span style="color:#111">f</span><span style="color:#111">:</span>
        <span style="color:#111">pickle</span><span style="color:#f92672">.</span><span style="color:#111">dump</span><span style="color:#111">(</span><span style="color:#111">EOD</span><span style="color:#111">,</span> <span style="color:#111">f</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><p>For the EOD data, we convert the daily adjusted close price to daily return for the convenience of our further operations.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">EOD</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">DataFrame</span><span style="color:#111">(</span><span style="color:#111">EOD</span><span style="color:#111">)</span>
<span style="color:#111">return_df</span> <span style="color:#f92672">=</span> <span style="color:#111">EOD</span><span style="color:#f92672">.</span><span style="color:#111">pct_change</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">return_df</span> <span style="color:#f92672">=</span> <span style="color:#111">return_df</span><span style="color:#f92672">.</span><span style="color:#111">dropna</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="3-sentiment-strength-analysis">3. Sentiment Strength Analysis</h2>
<p>To analyze the twitter users&rsquo; attitudes towards the stocks, after crawling data from twitter, we tried to analyze users&rsquo; tweets and generate a sentiment score for each of the tweet.</p>
<p>Here, we used a package named <strong>flair</strong>. Basically, flair&rsquo;s mechanism is simple. It contains a powerful library which allows users to use and combine different word and document embeddings. Based on the corpus, it could analyze and tell the attitudes of the speakers. Comparing with other NLP packages, flair&rsquo;s sentiment classifier is based on a character-level LSTM neural network which takes sequences of letters and words into account when predicting. It&rsquo;s based on a corpus but in the meantime, it could also predict a sentiment for OOV(Out of Vocab) words including typos.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">flair_sentiment</span> <span style="color:#f92672">=</span> <span style="color:#111">flair</span><span style="color:#f92672">.</span><span style="color:#111">models</span><span style="color:#f92672">.</span><span style="color:#111">TextClassifier</span><span style="color:#f92672">.</span><span style="color:#111">load</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">en-sentiment</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>2020-06-21 15:58:46,287 loading file /Users/christine/.flair/models/sentiment-en-mix-distillbert.pt
</code></pre>
<p>We created a function to computing the sentiment score of each tweet. The closer the number&rsquo;s absolute value to 1, the more certain the model is and the more extreme the attitudes of the users are. When the sentiment of a sentence is positive, the score is positive; when the sentiment of a sentence is negative, the score is negative. Amazingly, since the sentiment classifier could tell the intensifiers such as &lsquo;very&rsquo;, the score will vary when intensifiers are in the game.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">def</span> <span style="color:#75af00">senti_score</span><span style="color:#111">(</span><span style="color:#111">n</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">s</span> <span style="color:#f92672">=</span> <span style="color:#111">flair</span><span style="color:#f92672">.</span><span style="color:#111">data</span><span style="color:#f92672">.</span><span style="color:#111">Sentence</span><span style="color:#111">(</span><span style="color:#111">n</span><span style="color:#111">)</span>
    <span style="color:#111">flair_sentiment</span><span style="color:#f92672">.</span><span style="color:#111">predict</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">)</span>
    <span style="color:#111">total_sentiment</span> <span style="color:#f92672">=</span> <span style="color:#111">s</span><span style="color:#f92672">.</span><span style="color:#111">labels</span><span style="color:#111">[</span><span style="color:#ae81ff">0</span><span style="color:#111">]</span>
    <span style="color:#00a8c8">assert</span> <span style="color:#111">total_sentiment</span><span style="color:#f92672">.</span><span style="color:#111">value</span> <span style="color:#f92672">in</span> <span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">POSITIVE</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">NEGATIVE</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span>
    <span style="color:#111">sign</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span> <span style="color:#00a8c8">if</span> <span style="color:#111">total_sentiment</span><span style="color:#f92672">.</span><span style="color:#111">value</span> <span style="color:#f92672">==</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">POSITIVE</span><span style="color:#d88200">&#39;</span> <span style="color:#00a8c8">else</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>
    <span style="color:#111">score</span> <span style="color:#f92672">=</span> <span style="color:#111">total_sentiment</span><span style="color:#f92672">.</span><span style="color:#111">score</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">sign</span> <span style="color:#f92672">*</span> <span style="color:#111">score</span>
</code></pre></td></tr></table>
</div>
</div><p>Example: we used several examples to explain how the model works and how sensitive it is to intensifiers.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">s</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Tesla is a great company</span><span style="color:#d88200">&#39;</span>
<span style="color:#111">senti_score</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>0.9977720379829407
</code></pre>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">s</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Tesla is a good company</span><span style="color:#d88200">&#39;</span>
<span style="color:#111">senti_score</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>0.9961444139480591
</code></pre>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">s</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Tesla is just a company</span><span style="color:#d88200">&#39;</span>
<span style="color:#111">senti_score</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>-0.8988585472106934
</code></pre>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">s</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Tesla is a bad company</span><span style="color:#d88200">&#39;</span>
<span style="color:#111">senti_score</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>-0.9998192191123962
</code></pre>
<p>We used the model for each of the stock&rsquo;s tweets we got.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">tqdm</span><span style="color:#111">(</span><span style="color:#111">stock_pool</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">if</span> <span style="color:#111">os</span><span style="color:#f92672">.</span><span style="color:#111">path</span><span style="color:#f92672">.</span><span style="color:#111">isfile</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/{k}_with_sentiment.csv</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
        <span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">pass</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">k</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
        <span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">sentiment_score</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#111">senti_score</span><span style="color:#111">(</span><span style="color:#111">n</span><span style="color:#111">)</span> <span style="color:#00a8c8">for</span> <span style="color:#111">n</span> <span style="color:#f92672">in</span> <span style="color:#111">tqdm</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#111">]</span>
        <span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">to_csv</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/{k}_with_sentiment.csv</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><h2 id="4-preliminary-analysis">4. Preliminary Analysis</h2>
<p>After getting the sentiment scores of our tweets, before implementing the strategy we have, we did some preliminary analysis of the data.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">data</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#111">k</span><span style="color:#111">:</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">read_csv</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/{k}_with_sentiment.csv</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">lineterminator</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">index_col</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#111">parse_dates</span><span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#ae81ff">3</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">set_index</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">date_time</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span> <span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">stock_pool</span><span style="color:#111">}</span>
</code></pre></td></tr></table>
</div>
</div><h3 id="a-clean-the-tweets">A. Clean the tweets</h3>
<p>Since we directly crawled the tweets from Twitter, there&rsquo;re a lot of websites links, emojis and also invalid characters included in the tweets. Here, we used a package named <strong>nltk</strong> to help us clean and tokenize the tweets. By applying a <strong>stoplist</strong>, we seperated our tweets into a list of words and then we eliminated the invalid characters and links to keep the keywords.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">nltk</span><span style="color:#f92672">.</span><span style="color:#111">download</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">stopwords</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">nltk</span><span style="color:#f92672">.</span><span style="color:#111">download</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">punkt</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">nltk</span><span style="color:#f92672">.</span><span style="color:#111">download</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">averaged_perceptron_tagger</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">nltk</span><span style="color:#f92672">.</span><span style="color:#111">download</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">wordnet</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">stopword_list</span> <span style="color:#f92672">=</span> <span style="color:#111">stopwords</span><span style="color:#f92672">.</span><span style="color:#111">words</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">english</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">lemmatizer</span> <span style="color:#f92672">=</span> <span style="color:#111">WordNetLemmatizer</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>[nltk_data] Downloading package stopwords to
[nltk_data]     /Users/christine/nltk_data...
[nltk_data]   Package stopwords is already up-to-date!
[nltk_data] Downloading package punkt to /Users/christine/nltk_data...
[nltk_data]   Package punkt is already up-to-date!
[nltk_data] Downloading package averaged_perceptron_tagger to
[nltk_data]     /Users/christine/nltk_data...
[nltk_data]   Package averaged_perceptron_tagger is already up-to-
[nltk_data]       date!
[nltk_data] Downloading package wordnet to
[nltk_data]     /Users/christine/nltk_data...
[nltk_data]   Package wordnet is already up-to-date!
</code></pre>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">def</span> <span style="color:#75af00">clean_tweets</span><span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">astype</span><span style="color:#111">(</span><span style="color:#111">str</span><span style="color:#111">)</span>
    <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">map</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">x</span> <span style="color:#f92672">+</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200"> </span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span> 
    <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">map</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">re</span><span style="color:#f92672">.</span><span style="color:#111">sub</span><span style="color:#111">(</span><span style="color:#d88200">r</span><span style="color:#d88200">&#39;</span><span style="color:#d88200">http.*</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">x</span><span style="color:#111">)</span><span style="color:#111">)</span>
    <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">map</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">re</span><span style="color:#f92672">.</span><span style="color:#111">sub</span><span style="color:#111">(</span><span style="color:#d88200">r</span><span style="color:#d88200">&#34;</span><span style="color:#d88200">[^a-zA-Z#]</span><span style="color:#d88200">&#34;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200"> </span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">x</span><span style="color:#111">)</span><span style="color:#111">)</span>
    <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">map</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">x</span><span style="color:#f92672">.</span><span style="color:#111">lower</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span>
    <span style="color:#111">stopword_list</span> <span style="color:#f92672">=</span> <span style="color:#111">stopwords</span><span style="color:#f92672">.</span><span style="color:#111">words</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">english</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">range</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
        <span style="color:#111">tokens</span> <span style="color:#f92672">=</span> <span style="color:#111">word_tokenize</span><span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">)</span>
        <span style="color:#111">clean_tokens</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#111">w</span> <span style="color:#00a8c8">for</span> <span style="color:#111">w</span> <span style="color:#f92672">in</span> <span style="color:#111">tokens</span> <span style="color:#00a8c8">if</span> <span style="color:#111">w</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> <span style="color:#111">stopword_list</span><span style="color:#111">]</span>
        <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">clean_tokens</span>

<span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">tqdm</span><span style="color:#111">(</span><span style="color:#111">stock_pool</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">if</span> <span style="color:#111">os</span><span style="color:#f92672">.</span><span style="color:#111">path</span><span style="color:#f92672">.</span><span style="color:#111">isfile</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/{k}_with_sentiment_lemmatized .csv</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
        <span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">pass</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">k</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
        <span style="color:#111">clean_tweets</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#111">)</span>

<span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tesla</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">head</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>time</th>
<th>id</th>
<th>tweet</th>
<th>sentiment_score</th>
<th>tweet_cleaned</th>
</tr>
</thead>
<tbody>
<tr>
<td>2020-01-01 00:18:25</td>
<td>1212256747051577344</td>
<td>#Update: Tesla CEO Elon Musk spends part of #N&hellip;</td>
<td>-0.539993</td>
<td>[#, update, tesla, ceo, elon, musk, spends, pa&hellip;</td>
</tr>
<tr>
<td>2020-01-01 00:19:58</td>
<td>1212257135121162240</td>
<td>Executive mismanagement linked to fraud disgui&hellip;</td>
<td>-0.999139</td>
<td>[executive, mismanagement, linked, fraud, disg&hellip;</td>
</tr>
<tr>
<td>2020-01-01 00:20:35</td>
<td>1212257289668907008</td>
<td>Delivery announcement, Q4 earnings report and &hellip;</td>
<td>0.994400</td>
<td>[delivery, announcement, q, earnings, report, &hellip;</td>
</tr>
<tr>
<td>2020-01-01 00:25:22</td>
<td>1212258495992651776</td>
<td>Tesla is a great company but it doesn’t mean t&hellip;</td>
<td>-0.994792</td>
<td>[tesla, great, company, mean, success, guarant&hellip;</td>
</tr>
<tr>
<td>2020-01-01 00:28:44</td>
<td>1212259343606964224</td>
<td>This year was amazing. It was so great to be a&hellip;</td>
<td>0.997422</td>
<td>[year, amazing, great, among, incredible, peop&hellip;</td>
</tr>
</tbody>
</table>
<h3 id="b-lemmatization">B. Lemmatization</h3>
<p>We created a functoin in order to lemmatize our list of words by removing inflectional endings and returning the base or dictionary form of a word. It&rsquo;s also a standard step for NLP analysis.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">def</span> <span style="color:#75af00">lemmatize_tweet</span><span style="color:#111">(</span><span style="color:#111">tweet</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">range</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">tweet</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
        <span style="color:#00a8c8">for</span> <span style="color:#111">word</span> <span style="color:#f92672">in</span> <span style="color:#111">[</span><span style="color:#111">tweet</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">]</span><span style="color:#111">:</span>
            <span style="color:#111">pos_tag_list</span> <span style="color:#f92672">=</span> <span style="color:#111">nltk</span><span style="color:#f92672">.</span><span style="color:#111">pos_tag</span><span style="color:#111">(</span><span style="color:#111">word</span><span style="color:#111">)</span>
        <span style="color:#111">wordnet_tags</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#111">]</span>
        <span style="color:#00a8c8">for</span> <span style="color:#111">j</span> <span style="color:#f92672">in</span> <span style="color:#111">pos_tag_list</span><span style="color:#111">:</span>
            <span style="color:#00a8c8">if</span> <span style="color:#111">j</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">startswith</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">J</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
                <span style="color:#111">wordnet_tags</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">wordnet</span><span style="color:#f92672">.</span><span style="color:#111">ADJ</span><span style="color:#111">)</span>
            <span style="color:#00a8c8">elif</span> <span style="color:#111">j</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">startswith</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">N</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
                <span style="color:#111">wordnet_tags</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">wordnet</span><span style="color:#f92672">.</span><span style="color:#111">NOUN</span><span style="color:#111">)</span>
            <span style="color:#00a8c8">elif</span> <span style="color:#111">j</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">startswith</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">R</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
                <span style="color:#111">wordnet_tags</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">wordnet</span><span style="color:#f92672">.</span><span style="color:#111">ADV</span><span style="color:#111">)</span>
            <span style="color:#00a8c8">elif</span> <span style="color:#111">j</span><span style="color:#111">[</span><span style="color:#ae81ff">1</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">startswith</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">V</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
                <span style="color:#111">wordnet_tags</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">wordnet</span><span style="color:#f92672">.</span><span style="color:#111">VERB</span><span style="color:#111">)</span>
            <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
                <span style="color:#111">wordnet_tags</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">wordnet</span><span style="color:#f92672">.</span><span style="color:#111">NOUN</span><span style="color:#111">)</span>
        <span style="color:#111">lem_words</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#111">]</span>
        <span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">range</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">tweet</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
            <span style="color:#111">lem_words</span><span style="color:#f92672">.</span><span style="color:#111">append</span><span style="color:#111">(</span><span style="color:#111">lemmatizer</span><span style="color:#f92672">.</span><span style="color:#111">lemmatize</span><span style="color:#111">(</span><span style="color:#111">tweet</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#111">,</span> <span style="color:#111">pos</span><span style="color:#f92672">=</span><span style="color:#111">wordnet_tags</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#111">)</span>
        <span style="color:#111">lem_tweet</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200"> </span><span style="color:#d88200">&#39;</span><span style="color:#f92672">.</span><span style="color:#111">join</span><span style="color:#111">(</span><span style="color:#111">lem_words</span><span style="color:#111">)</span>
        <span style="color:#111">tweet</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">lem_tweet</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">tqdm</span><span style="color:#111">(</span><span style="color:#111">stock_pool</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#00a8c8">if</span> <span style="color:#111">os</span><span style="color:#f92672">.</span><span style="color:#111">path</span><span style="color:#f92672">.</span><span style="color:#111">isfile</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/{k}_with_sentiment_lemmatized .csv</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">:</span>
        <span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">pass</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">k</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
        <span style="color:#111">lemmatize_tweet</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">stock_pool</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">to_csv</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/{k}_with_sentiment_lemmatized.csv</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tesla</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span>
</code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>time</th>
<th>id</th>
<th>tweet</th>
<th>sentiment_score</th>
<th>tweet_cleaned</th>
</tr>
</thead>
<tbody>
<tr>
<td>2020-01-01 00:18:25</td>
<td>1212256747051577344</td>
<td>#Update: Tesla CEO Elon Musk spends part of #N&hellip;</td>
<td>-0.539993</td>
<td># update tesla ceo elon musk spend part # newy&hellip;</td>
</tr>
<tr>
<td>2020-01-01 00:19:58</td>
<td>1212257135121162240</td>
<td>Executive mismanagement linked to fraud disgui&hellip;</td>
<td>-0.999139</td>
<td>executive mismanagement link fraud disguise te&hellip;</td>
</tr>
<tr>
<td>2020-01-01 00:20:35</td>
<td>1212257289668907008</td>
<td>Delivery announcement, Q4 earnings report and &hellip;</td>
<td>0.994400</td>
<td>delivery announcement q earnings report batter&hellip;</td>
</tr>
<tr>
<td>2020-01-01 00:25:22</td>
<td>1212258495992651776</td>
<td>Tesla is a great company but it doesn’t mean t&hellip;</td>
<td>-0.994792</td>
<td>tesla great company mean success guarantee sti&hellip;</td>
</tr>
<tr>
<td>2020-01-01 00:28:44</td>
<td>1212259343606964224</td>
<td>This year was amazing. It was so great to be a&hellip;</td>
<td>0.997422</td>
<td>year amazing great among incredible people # t&hellip;</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>2020-05-31 18:13:29</td>
<td>1267232763570249732</td>
<td>My latest @cleantechnica article shares footag&hellip;</td>
<td>-0.995451</td>
<td>late cleantechnica article share footage erday&hellip;</td>
</tr>
<tr>
<td>2020-05-31 18:21:45</td>
<td>1267234842401550336</td>
<td>PUBLISHERS NOTE/\nComing On The Heals Of The @&hellip;</td>
<td>0.961094</td>
<td>publisher note come heals spacex usa nasa st m&hellip;</td>
</tr>
<tr>
<td>2020-05-31 18:31:45</td>
<td>1267237359021625353</td>
<td>they can really can ramp up and squeeze shorts&hellip;</td>
<td>0.919704</td>
<td>really ramp squeeze short sure want play elon &hellip;</td>
</tr>
<tr>
<td>2020-05-31 18:35:46</td>
<td>1267238371107041280</td>
<td>Quick Update on $TSLA - Wave 4 triangle has co&hellip;</td>
<td>0.999554</td>
<td>quick update tsla wave triangle complete # tes&hellip;</td>
</tr>
<tr>
<td>2020-05-31 18:42:40</td>
<td>1267240106018181120</td>
<td>Tesla continues to dominate electric vehicle t&hellip;</td>
<td>0.940820</td>
<td>tesla continue dominate electric vehicle techn&hellip;</td>
</tr>
</tbody>
</table>
<h3 id="c-word-cloud-and-frequency-analysis">C. Word Cloud and Frequency Analysis</h3>
<p>After cleaning, tokenizing and lemmatizing our data, we wanted to see when people mentioned our stocks on Twitter, what are the most frequently mentioned words. We did a frequency analysis of our tweet-word-list and formed WordCloud, the word-frequency plot and also the dataframe of the most frequent words people mentioned. We eliminated the single letters, special characters and invalid words such as &ldquo;inc&rdquo;, &ldquo;com&rdquo; and &ldquo;pic&rdquo; from the list to keep the word lists more relevant.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">data</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#111">k</span><span style="color:#111">:</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">read_csv</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">data/{k}_with_sentiment_lemmatized.csv</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">lineterminator</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#8045ff">\n</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">index_col</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#111">parse_dates</span><span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#ae81ff">0</span><span style="color:#111">]</span><span style="color:#111">)</span> <span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">stock_pool</span><span style="color:#111">}</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">stwds</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">inc</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">pic</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">com</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">#</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">+</span> <span style="color:#111">[</span><span style="color:#111">chr</span><span style="color:#111">(</span><span style="color:#111">i</span><span style="color:#111">)</span> <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">range</span><span style="color:#111">(</span><span style="color:#111">ord</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">A</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#111">,</span> <span style="color:#111">ord</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">z</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#111">)</span><span style="color:#111">]</span>
</code></pre></td></tr></table>
</div>
</div><div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">def</span> <span style="color:#75af00">freq_analysis</span><span style="color:#111">(</span><span style="color:#111">k</span><span style="color:#111">,</span> <span style="color:#111">plot</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#75715e"># Wordcloud</span>
    <span style="color:#111">df</span> <span style="color:#f92672">=</span> <span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">copy</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">astype</span><span style="color:#111">(</span><span style="color:#111">str</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">map</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200"> </span><span style="color:#d88200">&#39;</span><span style="color:#f92672">.</span><span style="color:#111">join</span><span style="color:#111">(</span><span style="color:#111">[</span><span style="color:#111">w</span> <span style="color:#00a8c8">for</span> <span style="color:#111">w</span> <span style="color:#f92672">in</span> <span style="color:#111">x</span><span style="color:#f92672">.</span><span style="color:#111">split</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#00a8c8">if</span> <span style="color:#111">w</span> <span style="color:#f92672">not</span> <span style="color:#f92672">in</span> <span style="color:#111">stwds</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#111">)</span>
    <span style="color:#111">complete_string</span> <span style="color:#f92672">=</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200"> </span><span style="color:#d88200">&#39;</span><span style="color:#f92672">.</span><span style="color:#111">join</span><span style="color:#111">(</span><span style="color:#111">[</span><span style="color:#111">tweet</span> <span style="color:#00a8c8">for</span> <span style="color:#111">tweet</span> <span style="color:#f92672">in</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tweet_cleaned</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">]</span><span style="color:#111">)</span>
    <span style="color:#111">word_list</span> <span style="color:#f92672">=</span> <span style="color:#111">complete_string</span><span style="color:#f92672">.</span><span style="color:#111">split</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#111">frequency</span> <span style="color:#f92672">=</span> <span style="color:#111">nltk</span><span style="color:#f92672">.</span><span style="color:#111">FreqDist</span><span style="color:#111">(</span><span style="color:#111">word_list</span><span style="color:#111">)</span>
    
    <span style="color:#00a8c8">if</span> <span style="color:#111">plot</span><span style="color:#111">:</span>
        <span style="color:#111">wordcloud</span> <span style="color:#f92672">=</span> <span style="color:#111">WordCloud</span><span style="color:#111">(</span>
            <span style="color:#111">width</span><span style="color:#f92672">=</span><span style="color:#ae81ff">900</span><span style="color:#111">,</span>
            <span style="color:#111">height</span><span style="color:#f92672">=</span><span style="color:#ae81ff">500</span><span style="color:#111">,</span>
            <span style="color:#111">max_words</span><span style="color:#f92672">=</span><span style="color:#ae81ff">500</span><span style="color:#111">,</span>
            <span style="color:#111">max_font_size</span><span style="color:#f92672">=</span><span style="color:#ae81ff">100</span><span style="color:#111">,</span>
            <span style="color:#111">relative_scaling</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0.5</span><span style="color:#111">,</span>
            <span style="color:#111">colormap</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Blues</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span>
            <span style="color:#111">background_color</span><span style="color:#f92672">=</span><span style="color:#111">None</span><span style="color:#111">,</span>
            <span style="color:#111">mode</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">RGBA</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span>
            <span style="color:#111">normalize_plurals</span><span style="color:#f92672">=</span><span style="color:#111">True</span>
        <span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">generate_from_frequencies</span><span style="color:#111">(</span><span style="color:#111">frequency</span><span style="color:#111">)</span>
        <span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">figure</span><span style="color:#111">(</span><span style="color:#111">figsize</span><span style="color:#f92672">=</span><span style="color:#111">(</span><span style="color:#ae81ff">17</span><span style="color:#111">,</span><span style="color:#ae81ff">14</span><span style="color:#111">)</span><span style="color:#111">)</span>
        <span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">imshow</span><span style="color:#111">(</span><span style="color:#111">wordcloud</span><span style="color:#111">,</span> <span style="color:#111">interpolation</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">bilinear</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
        <span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">axis</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#34;</span><span style="color:#d88200">off</span><span style="color:#d88200">&#34;</span><span style="color:#111">)</span>
        <span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">tight_layout</span><span style="color:#111">(</span><span style="color:#111">)</span>
        <span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">show</span><span style="color:#111">(</span><span style="color:#111">)</span>
    
    <span style="color:#75715e"># Word frequency analysis</span>
    <span style="color:#111">word_frequency</span> <span style="color:#f92672">=</span> <span style="color:#111">nltk</span><span style="color:#f92672">.</span><span style="color:#111">FreqDist</span><span style="color:#111">(</span><span style="color:#111">word_list</span><span style="color:#111">)</span>
    <span style="color:#111">frequency_df</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">DataFrame</span><span style="color:#111">(</span><span style="color:#111">{</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Word</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#111">list</span><span style="color:#111">(</span><span style="color:#111">word_frequency</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Count</span><span style="color:#d88200">&#39;</span><span style="color:#111">:</span> <span style="color:#111">list</span><span style="color:#111">(</span><span style="color:#111">word_frequency</span><span style="color:#f92672">.</span><span style="color:#111">values</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">}</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">sort_values</span><span style="color:#111">(</span><span style="color:#111">by</span><span style="color:#f92672">=</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Count</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">,</span> <span style="color:#111">ascending</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
    <span style="color:#111">frequency_df</span> <span style="color:#f92672">=</span> <span style="color:#111">frequency_df</span><span style="color:#111">[</span><span style="color:#111">(</span><span style="color:#111">frequency_df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Word</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">!=</span> <span style="color:#111">k</span><span style="color:#111">)</span> <span style="color:#f92672">&amp;</span> <span style="color:#111">(</span><span style="color:#111">frequency_df</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Word</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">!=</span> <span style="color:#111">stock_pool</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#111">]</span>
    <span style="color:#111">frequency_df</span> <span style="color:#f92672">=</span> <span style="color:#111">frequency_df</span><span style="color:#f92672">.</span><span style="color:#111">nlargest</span><span style="color:#111">(</span><span style="color:#111">columns</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#34;</span><span style="color:#d88200">Count</span><span style="color:#d88200">&#34;</span><span style="color:#111">,</span> <span style="color:#111">n</span><span style="color:#f92672">=</span><span style="color:#ae81ff">25</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">reset_index</span><span style="color:#111">(</span><span style="color:#111">drop</span><span style="color:#f92672">=</span><span style="color:#111">True</span><span style="color:#111">)</span>
    
    <span style="color:#00a8c8">if</span> <span style="color:#111">plot</span><span style="color:#111">:</span>
        <span style="color:#75715e"># Word frequency plot</span>
        <span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">figure</span><span style="color:#111">(</span><span style="color:#111">figsize</span><span style="color:#f92672">=</span><span style="color:#111">(</span><span style="color:#ae81ff">16</span><span style="color:#111">,</span><span style="color:#ae81ff">5</span><span style="color:#111">)</span><span style="color:#111">)</span>
        <span style="color:#111">ax</span> <span style="color:#f92672">=</span> <span style="color:#111">sns</span><span style="color:#f92672">.</span><span style="color:#111">barplot</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#f92672">=</span><span style="color:#111">frequency_df</span><span style="color:#111">,</span> <span style="color:#111">x</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#34;</span><span style="color:#d88200">Word</span><span style="color:#d88200">&#34;</span><span style="color:#111">,</span> <span style="color:#111">y</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#34;</span><span style="color:#d88200">Count</span><span style="color:#d88200">&#34;</span><span style="color:#111">)</span>
        <span style="color:#111">ax</span><span style="color:#f92672">.</span><span style="color:#111">set_ylabel</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Count</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
        <span style="color:#111">ax</span><span style="color:#f92672">.</span><span style="color:#111">set_xlabel</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Word</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
        <span style="color:#111">ax</span><span style="color:#f92672">.</span><span style="color:#111">set_xticklabels</span><span style="color:#111">(</span><span style="color:#111">ax</span><span style="color:#f92672">.</span><span style="color:#111">get_xticklabels</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">,</span> <span style="color:#111">rotation</span><span style="color:#f92672">=</span><span style="color:#ae81ff">40</span><span style="color:#111">,</span> <span style="color:#111">ha</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#34;</span><span style="color:#d88200">right</span><span style="color:#d88200">&#34;</span><span style="color:#111">,</span> <span style="color:#111">fontsize</span><span style="color:#f92672">=</span><span style="color:#ae81ff">12</span><span style="color:#111">)</span>
        <span style="color:#111">ax</span><span style="color:#f92672">.</span><span style="color:#111">set_title</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#34;</span><span style="color:#d88200">Word Frequency</span><span style="color:#d88200">&#34;</span><span style="color:#111">,</span> <span style="color:#111">fontsize</span><span style="color:#f92672">=</span><span style="color:#ae81ff">20</span><span style="color:#111">)</span>
        <span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">tight_layout</span><span style="color:#111">(</span><span style="color:#111">)</span>
        <span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">show</span><span style="color:#111">(</span><span style="color:#111">)</span>
    
    <span style="color:#00a8c8">return</span> <span style="color:#111">frequency_df</span>
</code></pre></td></tr></table>
</div>
</div><p>In order to illustrate what we did, I showed the full analysis process of the stock TSLA. Following are the WordCloud of the tesla tweets, word frequency plot.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">freq_analysis</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">tesla</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">plot</span><span style="color:#f92672">=</span><span style="color:#111">True</span><span style="color:#111">)</span><span style="color:#111">;</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/twitter_sentiment/output_47_0.png" alt="picture alt"></p>
<p><img src="/images/twitter_sentiment/output_47_1.png" alt="picture alt"></p>
<p>For the readability of this paper, we hid the WordCloud and the plots for the rest 9 stocks, however, we summarized the most frequently used words for the 10 stocks in our portfolio in the following dataframe.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">freq_analysis_result</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#111">k</span><span style="color:#111">:</span> <span style="color:#111">freq_analysis</span><span style="color:#111">(</span><span style="color:#111">k</span><span style="color:#111">)</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Word</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">stock_pool</span><span style="color:#111">}</span>

<span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">concat</span><span style="color:#111">(</span><span style="color:#111">freq_analysis_result</span><span style="color:#111">,</span> <span style="color:#111">keys</span><span style="color:#f92672">=</span><span style="color:#111">stock_pool</span><span style="color:#111">,</span> <span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>id</th>
<th>tesla</th>
<th>netflix</th>
<th>microsoft</th>
<th>zoom</th>
<th>apple</th>
<th>amazon</th>
<th>twitter</th>
<th>google</th>
<th>sony</th>
<th>nvidia</th>
</tr>
</thead>
<tbody>
<tr>
<td>0</td>
<td>stock</td>
<td>stock</td>
<td>corp</td>
<td>video</td>
<td>stock</td>
<td>nan</td>
<td>stock</td>
<td>goog</td>
<td>twitter</td>
<td>stock</td>
</tr>
<tr>
<td>1</td>
<td>tslaq</td>
<td>twitter</td>
<td>stock</td>
<td>stock</td>
<td>market</td>
<td>check</td>
<td>jack</td>
<td>alphabet</td>
<td>aapl</td>
<td>amd</td>
</tr>
<tr>
<td>2</td>
<td>twitter</td>
<td>earnings</td>
<td>market</td>
<td>security</td>
<td>price</td>
<td>stock</td>
<td>fb</td>
<td>stock</td>
<td>apple</td>
<td>earnings</td>
</tr>
<tr>
<td>3</td>
<td>market</td>
<td>price</td>
<td>rating</td>
<td>verb</td>
<td>iphone</td>
<td>twitter</td>
<td>price</td>
<td>cloud</td>
<td>playstation</td>
<td>price</td>
</tr>
<tr>
<td>4</td>
<td>car</td>
<td>dis</td>
<td>twitter</td>
<td>communication</td>
<td>twitter</td>
<td>market</td>
<td>like</td>
<td>twitter</td>
<td>nikkei</td>
<td>corporation</td>
</tr>
<tr>
<td>5</td>
<td>elonmusk</td>
<td>new</td>
<td>change</td>
<td>twitter</td>
<td>new</td>
<td>buy</td>
<td>tweet</td>
<td>apple</td>
<td>tokyo</td>
<td>target</td>
</tr>
<tr>
<td>6</td>
<td>elon</td>
<td>high</td>
<td>result</td>
<td>msft</td>
<td>buy</td>
<td>company</td>
<td>go</td>
<td>coronavirus</td>
<td>jpm</td>
<td>twitter</td>
</tr>
<tr>
<td>7</td>
<td>go</td>
<td>buy</td>
<td>surprise</td>
<td>use</td>
<td>coronavirus</td>
<td>aapl</td>
<td>get</td>
<td>aapl</td>
<td>msft</td>
<td>high</td>
</tr>
<tr>
<td>8</td>
<td>short</td>
<td>stream</td>
<td>cloud</td>
<td>company</td>
<td>close</td>
<td>apple</td>
<td>trump</td>
<td>amzn</td>
<td>market</td>
<td>buy</td>
</tr>
<tr>
<td>9</td>
<td>price</td>
<td>market</td>
<td>team</td>
<td>conferencing</td>
<td>rating</td>
<td>earnings</td>
<td>user</td>
<td>new</td>
<td>rkuny</td>
<td>new</td>
</tr>
<tr>
<td>10</td>
<td>model</td>
<td>amzn</td>
<td>amzn</td>
<td>secure</td>
<td>earnings</td>
<td>get</td>
<td>company</td>
<td>fb</td>
<td>amzn</td>
<td>ai</td>
</tr>
<tr>
<td>11</td>
<td>buy</td>
<td>disney</td>
<td>apple</td>
<td>buy</td>
<td>china</td>
<td>fb</td>
<td>facebook</td>
<td>company</td>
<td>nflx</td>
<td>corp</td>
</tr>
<tr>
<td>12</td>
<td>musk</td>
<td>subscriber</td>
<td>new</td>
<td>platform</td>
<td>change</td>
<td>say</td>
<td>time</td>
<td>amazon</td>
<td>goog</td>
<td>indicator</td>
</tr>
<tr>
<td>13</td>
<td>get</td>
<td>share</td>
<td>buy</td>
<td>tech</td>
<td>store</td>
<td>year</td>
<td>share</td>
<td>msft</td>
<td>get</td>
<td>share</td>
</tr>
<tr>
<td>14</td>
<td>share</td>
<td>watch</td>
<td>aapl</td>
<td>orcl</td>
<td>amzn</td>
<td>msft</td>
<td>would</td>
<td>facebook</td>
<td>rakuten</td>
<td>nasdaq</td>
</tr>
<tr>
<td>15</td>
<td>year</td>
<td>trade</td>
<td>amazon</td>
<td>work</td>
<td>result</td>
<td>new</td>
<td>close</td>
<td>microsoft</td>
<td>pt</td>
<td>raise</td>
</tr>
<tr>
<td>16</td>
<td>day</td>
<td>long</td>
<td>work</td>
<td>co</td>
<td>year</td>
<td>time</td>
<td>say</td>
<td>say</td>
<td>stock</td>
<td>short</td>
</tr>
<tr>
<td>17</td>
<td>make</td>
<td>short</td>
<td>earnings</td>
<td>launch</td>
<td>share</td>
<td>black</td>
<td>make</td>
<td>make</td>
<td>therealthing</td>
<td>market</td>
</tr>
<tr>
<td>18</td>
<td>company</td>
<td>content</td>
<td>company</td>
<td>crm</td>
<td>msft</td>
<td>bezos</td>
<td>ceo</td>
<td>work</td>
<td>theoneandonly</td>
<td>analyst</td>
</tr>
<tr>
<td>19</td>
<td>say</td>
<td>see</td>
<td>say</td>
<td>user</td>
<td>say</td>
<td>share</td>
<td>buy</td>
<td>business</td>
<td>fb</td>
<td>trade</td>
</tr>
<tr>
<td>20</td>
<td>sell</td>
<td>close</td>
<td>price</td>
<td>market</td>
<td>company</td>
<td>high</td>
<td>day</td>
<td>year</td>
<td>sensor</td>
<td>close</td>
</tr>
<tr>
<td>21</td>
<td>like</td>
<td>amazon</td>
<td>year</td>
<td>shop</td>
<td>surprise</td>
<td>one</td>
<td>new</td>
<td>ad</td>
<td>bac</td>
<td>data</td>
</tr>
<tr>
<td>22</td>
<td>new</td>
<td>year</td>
<td>coronavirus</td>
<td>go</td>
<td>sell</td>
<td>wireless</td>
<td>see</td>
<td>revenue</td>
<td>year</td>
<td>center</td>
</tr>
<tr>
<td>23</td>
<td>china</td>
<td>go</td>
<td>corporation</td>
<td>people</td>
<td>nasdaq</td>
<td>microsoft</td>
<td>year</td>
<td>youtube</td>
<td>buy</td>
<td>rating</td>
</tr>
<tr>
<td>24</td>
<td>time</td>
<td>target</td>
<td>report</td>
<td>partner</td>
<td>amazon</td>
<td>day</td>
<td>account</td>
<td>covid</td>
<td>game</td>
<td>report</td>
</tr>
</tbody>
</table>
<h2 id="5-trading-strategy">5. Trading Strategy</h2>
<p>Warren Buffet once said, <em>We simply attempt to be fearful when others are greedy and to be greedy only when others are fearful</em>. His words are the source of our idea of this strategy.</p>
<p>Our strategy is based on people&rsquo;s reaction of today&rsquo;s market. We collected every tweet from today&rsquo;s 16:00(today&rsquo;s market close) to next day&rsquo;s 9:00 (next day&rsquo;s market open). Based on people&rsquo;s attitude towards today&rsquo;s market performance, we make the opposite move.</p>
<h3 id="a-original-plan">A. Original Plan</h3>
<p>Go long three stocks which have the lowest score and short three stocks with have the highest score.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">def</span> <span style="color:#75af00">night_filter</span><span style="color:#111">(</span><span style="color:#111">df</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">same_night</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">index</span><span style="color:#f92672">.</span><span style="color:#111">to_series</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">t</span><span style="color:#111">:</span> <span style="color:#111">t</span><span style="color:#f92672">.</span><span style="color:#111">hour</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">15</span><span style="color:#111">)</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">sentiment_score</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">resample</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">D</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">sum</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#111">next_morning</span> <span style="color:#f92672">=</span> <span style="color:#111">df</span><span style="color:#111">[</span><span style="color:#111">df</span><span style="color:#f92672">.</span><span style="color:#111">index</span><span style="color:#f92672">.</span><span style="color:#111">to_series</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#00a8c8">lambda</span> <span style="color:#111">t</span><span style="color:#111">:</span> <span style="color:#111">t</span><span style="color:#f92672">.</span><span style="color:#111">hour</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">9</span><span style="color:#111">)</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">sentiment_score</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">resample</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">D</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">sum</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">(</span><span style="color:#111">same_night</span> <span style="color:#f92672">+</span> <span style="color:#111">next_morning</span><span style="color:#f92672">.</span><span style="color:#111">shift</span><span style="color:#111">(</span><span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">fillna</span><span style="color:#111">(</span><span style="color:#ae81ff">0</span><span style="color:#111">)</span>

<span style="color:#111">thresh</span> <span style="color:#f92672">=</span> <span style="color:#f92672">.</span><span style="color:#ae81ff">5</span>
<span style="color:#111">score_df</span> <span style="color:#f92672">=</span> <span style="color:#111">{</span><span style="color:#111">k</span><span style="color:#111">:</span> <span style="color:#111">night_filter</span><span style="color:#111">(</span><span style="color:#111">data</span><span style="color:#111">[</span><span style="color:#111">k</span><span style="color:#111">]</span><span style="color:#111">)</span> <span style="color:#00a8c8">for</span> <span style="color:#111">k</span> <span style="color:#f92672">in</span> <span style="color:#111">stock_pool</span><span style="color:#111">}</span>
<span style="color:#111">score_df</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">concat</span><span style="color:#111">(</span><span style="color:#111">score_df</span><span style="color:#111">,</span> <span style="color:#111">keys</span><span style="color:#f92672">=</span><span style="color:#111">score_df</span><span style="color:#111">,</span> <span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>

<span style="color:#111">pos_df_2</span> <span style="color:#f92672">=</span> <span style="color:#111">score_df</span><span style="color:#f92672">.</span><span style="color:#111">shift</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">loc</span><span style="color:#111">[</span><span style="color:#111">return_df</span><span style="color:#f92672">.</span><span style="color:#111">index</span><span style="color:#111">]</span>
<span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">range</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">pos_df_2</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">long</span> <span style="color:#f92672">=</span> <span style="color:#111">pos_df_2</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">nsmallest</span><span style="color:#111">(</span><span style="color:#ae81ff">3</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#111">short</span> <span style="color:#f92672">=</span> <span style="color:#111">pos_df_2</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">nlargest</span><span style="color:#111">(</span><span style="color:#ae81ff">3</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">keys</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">for</span> <span style="color:#111">key</span> <span style="color:#f92672">in</span> <span style="color:#111">pos_df_2</span><span style="color:#111">:</span>
        <span style="color:#00a8c8">if</span> <span style="color:#111">key</span> <span style="color:#f92672">in</span> <span style="color:#111">long</span><span style="color:#111">:</span>
            <span style="color:#111">pos_df_2</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#111">key</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>
        <span style="color:#00a8c8">elif</span> <span style="color:#111">key</span> <span style="color:#f92672">in</span> <span style="color:#111">short</span><span style="color:#111">:</span>
            <span style="color:#111">pos_df_2</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#111">key</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#ae81ff">1</span><span style="color:#f92672">/</span><span style="color:#ae81ff">3</span>
        <span style="color:#00a8c8">else</span><span style="color:#111">:</span>
            <span style="color:#111">pos_df_2</span><span style="color:#f92672">.</span><span style="color:#111">iloc</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span><span style="color:#111">[</span><span style="color:#111">key</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">0</span>
<span style="color:#111">pos_df_2</span>
</code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>time</th>
<th>tesla</th>
<th>netflix</th>
<th>microsoft</th>
<th>zoom</th>
<th>apple</th>
<th>amazon</th>
<th>twitter</th>
<th>google</th>
<th>sony</th>
<th>nvidia</th>
</tr>
</thead>
<tbody>
<tr>
<td>2020-01-03</td>
<td>0.333333</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.000000</td>
</tr>
<tr>
<td>2020-01-06</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>-0.333333</td>
</tr>
<tr>
<td>2020-01-07</td>
<td>0.333333</td>
<td>0.333333</td>
<td>-0.333333</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.333333</td>
</tr>
<tr>
<td>2020-01-08</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>-0.333333</td>
</tr>
<tr>
<td>2020-01-09</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.333333</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>-0.333333</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.333333</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>2020-05-22</td>
<td>0.333333</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>-0.333333</td>
<td>0.333333</td>
</tr>
<tr>
<td>2020-05-26</td>
<td>0.000000</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>-0.333333</td>
<td>0.000000</td>
<td>0.333333</td>
</tr>
<tr>
<td>2020-05-27</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.000000</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>-0.333333</td>
</tr>
<tr>
<td>2020-05-28</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.000000</td>
<td>0.333333</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>0.000000</td>
<td>0.000000</td>
<td>-0.333333</td>
</tr>
<tr>
<td>2020-05-29</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.000000</td>
<td>0.333333</td>
<td>-0.333333</td>
<td>0.333333</td>
<td>0.000000</td>
<td>-0.333333</td>
<td>0.000000</td>
</tr>
</tbody>
</table>
<p>We set the <strong>benchmark</strong> of this strategy to be hold the 10 stocks evenly everyday. Also, we set the <strong>alpha</strong> to be the excess return of the strategy.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">benchmark_2</span> <span style="color:#f92672">=</span> <span style="color:#111">return_df</span><span style="color:#f92672">.</span><span style="color:#111">mean</span><span style="color:#111">(</span><span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>
<span style="color:#111">benchmark_2</span><span style="color:#f92672">.</span><span style="color:#111">cumsum</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">plot</span><span style="color:#111">(</span><span style="color:#111">color</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">k</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">label</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">benchmark</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">strategy_2</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span><span style="color:#111">return_df</span> <span style="color:#f92672">*</span> <span style="color:#111">pos_df_2</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">sum</span><span style="color:#111">(</span><span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>
<span style="color:#111">strategy_2</span><span style="color:#f92672">.</span><span style="color:#111">cumsum</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">plot</span><span style="color:#111">(</span><span style="color:#111">color</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">r</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">label</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">strategy (absolute return)</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">alpha_2</span> <span style="color:#f92672">=</span> <span style="color:#111">strategy_2</span> <span style="color:#f92672">-</span> <span style="color:#111">benchmark_2</span>
<span style="color:#111">alpha_2</span><span style="color:#f92672">.</span><span style="color:#111">cumsum</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">plot</span><span style="color:#111">(</span><span style="color:#111">color</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">c</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">label</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">alpha (excess return)</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">xticks</span><span style="color:#111">(</span><span style="color:#111">rotation</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#111">ha</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">center</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">tight_layout</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">legend</span><span style="color:#111">(</span><span style="color:#111">frameon</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">ylabel</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Cum PnL (</span><span style="color:#d88200">%</span><span style="color:#d88200">)</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">show</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/twitter_sentiment/output_56_0.png" alt="picture alt"></p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">sharpe</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">x</span><span style="color:#f92672">.</span><span style="color:#111">mean</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#f92672">/</span> <span style="color:#111">x</span><span style="color:#f92672">.</span><span style="color:#111">std</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">252</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">.</span><span style="color:#ae81ff">5</span>
<span style="color:#111">sortino</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">lambda</span> <span style="color:#111">x</span><span style="color:#111">:</span> <span style="color:#111">x</span><span style="color:#f92672">.</span><span style="color:#111">mean</span><span style="color:#111">(</span><span style="color:#111">)</span> <span style="color:#f92672">/</span> <span style="color:#111">(</span><span style="color:#111">(</span><span style="color:#111">(</span><span style="color:#111">x</span> <span style="color:#f92672">-</span> <span style="color:#111">x</span><span style="color:#f92672">.</span><span style="color:#111">mean</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#ae81ff">2</span> <span style="color:#f92672">*</span> <span style="color:#111">(</span><span style="color:#111">x</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">mean</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">.</span><span style="color:#ae81ff">5</span> <span style="color:#f92672">*</span> <span style="color:#ae81ff">252</span><span style="color:#f92672">*</span><span style="color:#f92672">*</span><span style="color:#f92672">.</span><span style="color:#ae81ff">5</span>


<span style="color:#00a8c8">def</span> <span style="color:#75af00">maximum_drawdown</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">cumx</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span><span style="color:#111">x</span> <span style="color:#f92672">+</span> <span style="color:#ae81ff">1</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">cumprod</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">return</span> <span style="color:#111">(</span><span style="color:#ae81ff">1</span> <span style="color:#f92672">-</span> <span style="color:#111">cumx</span> <span style="color:#f92672">/</span> <span style="color:#111">cumx</span><span style="color:#f92672">.</span><span style="color:#111">cummax</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">max</span><span style="color:#111">(</span><span style="color:#111">)</span>


<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">SR(benchmark) = {sharpe(benchmark_2):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">SR(strategy) = {sharpe(strategy_2):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">SR(alpha) = {sharpe(alpha_2):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Sortino(benchmark) = {sortino(benchmark_2):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Sortino(strategy) = {sortino(strategy_2):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Sortino(alpha) = {sortino(alpha_2):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Max_Drawdown(benchmark) = {maximum_drawdown(benchmark_2):.1</span><span style="color:#d88200">%</span><span style="color:#d88200">}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Max_Drawdown(strategy) = {maximum_drawdown(strategy_2):.1</span><span style="color:#d88200">%</span><span style="color:#d88200">}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Max_Drawdown(alpha) = {maximum_drawdown(alpha_2):.1</span><span style="color:#d88200">%</span><span style="color:#d88200">}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>SR(benchmark) = 1.87
SR(strategy) = -0.10
SR(alpha) = -1.78

Sortino(benchmark) = 2.45
Sortino(strategy) = -0.13
Sortino(alpha) = -2.33

Max_Drawdown(benchmark) = 27.9%
Max_Drawdown(strategy) = 32.5%
Max_Drawdown(alpha) = 44.1%
</code></pre>
<p>From the result, we could see that the Sharpe Ratio of our strategy is not good&hellip;(negative SR), so we tried to improve our strategy.</p>
<h3 id="b-improvement">B. Improvement</h3>
<p>Instead of taking the highest three scores and lowest three scores, we took the sum of every tweet&rsquo;s positive sentiment score and also negative sentiment scores in this time period (which indicates people&rsquo;s attitudes towards today&rsquo;s market performance by sentiment score and also the volume, the higher the volume, the more satisfied/disappointed people are). Based on the sum of the score we got for each stock, we normalize our positive and negative scores by seperately dividing the positive/negative sums of the sentiment scores to achieve <strong>market neutral</strong>, which means this does not cost us but in the meantime makes us money.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">def</span> <span style="color:#75af00">normalize</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">pos_sum</span> <span style="color:#f92672">=</span> <span style="color:#111">s</span><span style="color:#111">[</span><span style="color:#111">s</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">sum</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#111">neg_sum</span> <span style="color:#f92672">=</span> <span style="color:#111">s</span><span style="color:#111">[</span><span style="color:#111">s</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span><span style="color:#111">]</span><span style="color:#f92672">.</span><span style="color:#111">sum</span><span style="color:#111">(</span><span style="color:#111">)</span>
    <span style="color:#00a8c8">for</span> <span style="color:#111">i</span> <span style="color:#f92672">in</span> <span style="color:#111">range</span><span style="color:#111">(</span><span style="color:#111">len</span><span style="color:#111">(</span><span style="color:#111">s</span><span style="color:#111">)</span><span style="color:#111">)</span><span style="color:#111">:</span>
        <span style="color:#111">s</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span> <span style="color:#f92672">/</span><span style="color:#f92672">=</span> <span style="color:#111">pos_sum</span> <span style="color:#00a8c8">if</span> <span style="color:#111">s</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">0</span> <span style="color:#00a8c8">else</span> <span style="color:#111">neg_sum</span> <span style="color:#00a8c8">if</span> <span style="color:#111">s</span><span style="color:#111">[</span><span style="color:#111">i</span><span style="color:#111">]</span> <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">0</span> <span style="color:#00a8c8">else</span> <span style="color:#ae81ff">1</span>

<span style="color:#111">pos_df</span> <span style="color:#f92672">=</span> <span style="color:#f92672">-</span><span style="color:#111">score_df</span><span style="color:#f92672">.</span><span style="color:#111">shift</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">loc</span><span style="color:#111">[</span><span style="color:#111">return_df</span><span style="color:#f92672">.</span><span style="color:#111">index</span><span style="color:#111">]</span>
<span style="color:#00a8c8">for</span> <span style="color:#111">i</span><span style="color:#111">,</span> <span style="color:#111">row</span> <span style="color:#f92672">in</span> <span style="color:#111">pos_df</span><span style="color:#f92672">.</span><span style="color:#111">iterrows</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#111">:</span>
    <span style="color:#111">normalize</span><span style="color:#111">(</span><span style="color:#111">row</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><table>
<thead>
<tr>
<th>time</th>
<th>tesla</th>
<th>netflix</th>
<th>microsoft</th>
<th>zoom</th>
<th>apple</th>
<th>amazon</th>
<th>twitter</th>
<th>google</th>
<th>sony</th>
<th>nvidia</th>
</tr>
</thead>
<tbody>
<tr>
<td>2020-01-03</td>
<td>0.401892</td>
<td>0.114972</td>
<td>0.059096</td>
<td>-0.000000</td>
<td>0.330018</td>
<td>0.020177</td>
<td>0.009599</td>
<td>0.044186</td>
<td>0.008309</td>
<td>0.011751</td>
</tr>
<tr>
<td>2020-01-06</td>
<td>0.270341</td>
<td>0.065981</td>
<td>0.042288</td>
<td>-0.000000</td>
<td>0.393034</td>
<td>0.095976</td>
<td>0.058378</td>
<td>0.040528</td>
<td>0.020787</td>
<td>0.012688</td>
</tr>
<tr>
<td>2020-01-07</td>
<td>0.442299</td>
<td>0.105930</td>
<td>0.021281</td>
<td>-0.000000</td>
<td>0.201535</td>
<td>0.080591</td>
<td>0.065456</td>
<td>0.041283</td>
<td>0.026490</td>
<td>0.015135</td>
</tr>
<tr>
<td>2020-01-08</td>
<td>0.407693</td>
<td>0.066788</td>
<td>0.079381</td>
<td>0.009896</td>
<td>0.220641</td>
<td>0.052692</td>
<td>0.103467</td>
<td>0.031961</td>
<td>0.003662</td>
<td>0.023819</td>
</tr>
<tr>
<td>2020-01-09</td>
<td>0.360541</td>
<td>0.041014</td>
<td>0.081616</td>
<td>0.000709</td>
<td>0.361786</td>
<td>0.014596</td>
<td>0.078035</td>
<td>0.021689</td>
<td>0.024410</td>
<td>0.015605</td>
</tr>
<tr>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
<td>&hellip;</td>
</tr>
<tr>
<td>2020-05-22</td>
<td>0.209791</td>
<td>0.150681</td>
<td>0.040223</td>
<td>0.017995</td>
<td>0.136417</td>
<td>0.125920</td>
<td>0.106557</td>
<td>0.020171</td>
<td>0.032025</td>
<td>0.160221</td>
</tr>
<tr>
<td>2020-05-26</td>
<td>0.144673</td>
<td>0.100749</td>
<td>0.102627</td>
<td>0.014581</td>
<td>0.261007</td>
<td>1.000000</td>
<td>0.154036</td>
<td>0.018609</td>
<td>0.032293</td>
<td>0.171425</td>
</tr>
<tr>
<td>2020-05-27</td>
<td>0.279436</td>
<td>0.054341</td>
<td>0.014196</td>
<td>0.023837</td>
<td>0.138186</td>
<td>0.071761</td>
<td>0.367798</td>
<td>0.029868</td>
<td>0.000406</td>
<td>0.020169</td>
</tr>
<tr>
<td>2020-05-28</td>
<td>0.096364</td>
<td>0.065429</td>
<td>0.617590</td>
<td>0.011994</td>
<td>0.216065</td>
<td>0.382410</td>
<td>0.526869</td>
<td>0.055728</td>
<td>0.019243</td>
<td>0.008308</td>
</tr>
<tr>
<td>2020-05-29</td>
<td>0.235185</td>
<td>0.031032</td>
<td>0.331849</td>
<td>0.029525</td>
<td>0.125487</td>
<td>0.668151</td>
<td>0.526221</td>
<td>0.032061</td>
<td>-0.000000</td>
<td>0.020488</td>
</tr>
</tbody>
</table>
<p>To evaluate the performance, like before, we also set the <strong>benchmark</strong> of this strategy to be hold the 10 stocks evenly everyday. Also, we set the <strong>alpha</strong> to be the excess return of the strategy.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">benchmark</span> <span style="color:#f92672">=</span> <span style="color:#111">return_df</span><span style="color:#f92672">.</span><span style="color:#111">mean</span><span style="color:#111">(</span><span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>
<span style="color:#111">benchmark</span><span style="color:#f92672">.</span><span style="color:#111">cumsum</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">plot</span><span style="color:#111">(</span><span style="color:#111">color</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">k</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">label</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">benchmark</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">strategy</span> <span style="color:#f92672">=</span> <span style="color:#111">(</span><span style="color:#111">return_df</span> <span style="color:#f92672">*</span> <span style="color:#111">pos_df</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">sum</span><span style="color:#111">(</span><span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>
<span style="color:#111">strategy</span><span style="color:#f92672">.</span><span style="color:#111">cumsum</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">plot</span><span style="color:#111">(</span><span style="color:#111">color</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">r</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">label</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">strategy (absolute return)</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">alpha</span> <span style="color:#f92672">=</span> <span style="color:#111">strategy</span> <span style="color:#f92672">-</span> <span style="color:#111">benchmark</span>
<span style="color:#111">alpha</span><span style="color:#f92672">.</span><span style="color:#111">cumsum</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">plot</span><span style="color:#111">(</span><span style="color:#111">color</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">c</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">label</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">alpha (excess return)</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">xticks</span><span style="color:#111">(</span><span style="color:#111">rotation</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#111">,</span> <span style="color:#111">ha</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">center</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">tight_layout</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">legend</span><span style="color:#111">(</span><span style="color:#111">frameon</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">ylabel</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Cum PnL (</span><span style="color:#d88200">%</span><span style="color:#d88200">)</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">show</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/twitter_sentiment/output_62_0.png" alt="picture alt"></p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">SR(benchmark) = {sharpe(benchmark):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">SR(strategy) = {sharpe(strategy):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">SR(alpha) = {sharpe(alpha):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Sortino(benchmark) = {sortino(benchmark):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Sortino(strategy) = {sortino(strategy):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Sortino(alpha) = {sortino(alpha):.2f}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Max_Drawdown(benchmark) = {maximum_drawdown(benchmark):.1</span><span style="color:#d88200">%</span><span style="color:#d88200">}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Max_Drawdown(strategy) = {maximum_drawdown(strategy):.1</span><span style="color:#d88200">%</span><span style="color:#d88200">}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
<span style="color:#00a8c8">print</span><span style="color:#111">(</span><span style="color:#111">f</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Max_Drawdown(alpha) = {maximum_drawdown(alpha):.1</span><span style="color:#d88200">%</span><span style="color:#d88200">}</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><pre><code>SR(benchmark) = 1.87
SR(strategy) = 2.94
SR(alpha) = 3.01

Sortino(benchmark) = 2.45
Sortino(strategy) = 4.36
Sortino(alpha) = 5.03

Max_Drawdown(benchmark) = 27.9%
Max_Drawdown(strategy) = 27.1%
Max_Drawdown(alpha) = 12.2%
</code></pre>
<p>From the Sharpe ratio and the result we got, there&rsquo;s a huge improvement. It illustrates that insteading of choosing the best and worse to go long and short evenly, we normally distribute our positions based on their level of scores. It&rsquo;s more statistically significant. This is the strategy we&rsquo;re gonna use.</p>
<h3 id="c-monthly-analysis">C. Monthly Analysis</h3>
<p>After setting the strategy, we digged into the monthly ratio to see the monthly performance.</p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">performance</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">concat</span><span style="color:#111">(</span><span style="color:#111">[</span><span style="color:#111">benchmark</span><span style="color:#111">,</span> <span style="color:#111">strategy</span><span style="color:#111">,</span> <span style="color:#111">alpha</span><span style="color:#111">]</span><span style="color:#111">,</span> <span style="color:#111">axis</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1</span><span style="color:#111">)</span>
<span style="color:#111">performance</span><span style="color:#f92672">.</span><span style="color:#111">columns</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Benchmark</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Strategy</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">Alpha</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span>
</code></pre></td></tr></table>
</div>
</div><h4 id="a-sharpe-ratio">a. Sharpe Ratio</h4>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">sharpe_month</span> <span style="color:#f92672">=</span> <span style="color:#111">performance</span><span style="color:#f92672">.</span><span style="color:#111">resample</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">M</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#111">sharpe</span><span style="color:#111">)</span>
<span style="color:#111">sharpe_month</span> <span style="color:#f92672">=</span> <span style="color:#111">sharpe_month</span><span style="color:#f92672">.</span><span style="color:#111">stack</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">reset_index</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">sharpe_month</span><span style="color:#f92672">.</span><span style="color:#111">columns</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">class</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">value</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span>
<span style="color:#111">sharpe_month</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">to_datetime</span><span style="color:#111">(</span><span style="color:#111">sharpe_month</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">strftime</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">%</span><span style="color:#d88200">b</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>

<span style="color:#111">g_sharpe</span> <span style="color:#f92672">=</span> <span style="color:#111">sns</span><span style="color:#f92672">.</span><span style="color:#111">catplot</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">y</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">value</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">hue</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">class</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">kind</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">bar</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">data</span><span style="color:#f92672">=</span><span style="color:#111">sharpe_month</span><span style="color:#111">,</span> <span style="color:#111">legend</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
<span style="color:#111">g_sharpe</span><span style="color:#f92672">.</span><span style="color:#111">despine</span><span style="color:#111">(</span><span style="color:#111">left</span><span style="color:#f92672">=</span><span style="color:#111">True</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">legend</span><span style="color:#111">(</span><span style="color:#111">loc</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">upper right</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">frameon</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">tight_layout</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">show</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/twitter_sentiment/output_70_0.png" alt="picture alt"></p>
<h4 id="b-sortino-ratio">b. Sortino Ratio</h4>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">performance</span><span style="color:#f92672">.</span><span style="color:#111">resample</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">M</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#111">sortino</span><span style="color:#111">)</span>

<span style="color:#111">sortino_month</span> <span style="color:#f92672">=</span> <span style="color:#111">performance</span><span style="color:#f92672">.</span><span style="color:#111">resample</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">M</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#111">sortino</span><span style="color:#111">)</span>
<span style="color:#111">sortino_month</span> <span style="color:#f92672">=</span> <span style="color:#111">sortino_month</span><span style="color:#f92672">.</span><span style="color:#111">stack</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">reset_index</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">sortino_month</span><span style="color:#f92672">.</span><span style="color:#111">columns</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">class</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">value</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span>
<span style="color:#111">sortino_month</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">to_datetime</span><span style="color:#111">(</span><span style="color:#111">sortino_month</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">strftime</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">%</span><span style="color:#d88200">b</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>

<span style="color:#111">g_sortino</span> <span style="color:#f92672">=</span> <span style="color:#111">sns</span><span style="color:#f92672">.</span><span style="color:#111">catplot</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">y</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">value</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">hue</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">class</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">kind</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">bar</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">data</span><span style="color:#f92672">=</span><span style="color:#111">sortino_month</span><span style="color:#111">,</span> <span style="color:#111">legend</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
<span style="color:#111">g_sortino</span><span style="color:#f92672">.</span><span style="color:#111">despine</span><span style="color:#111">(</span><span style="color:#111">left</span><span style="color:#f92672">=</span><span style="color:#111">True</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">legend</span><span style="color:#111">(</span><span style="color:#111">loc</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">upper right</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">frameon</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">tight_layout</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">show</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/twitter_sentiment/output_74_0.png" alt="picture alt"></p>
<div class="highlight"><div style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#111">performance</span><span style="color:#f92672">.</span><span style="color:#111">resample</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">M</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#111">maximum_drawdown</span><span style="color:#111">)</span>

<span style="color:#111">maxdraw_month</span> <span style="color:#f92672">=</span> <span style="color:#111">performance</span><span style="color:#f92672">.</span><span style="color:#111">resample</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">M</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">apply</span><span style="color:#111">(</span><span style="color:#111">maximum_drawdown</span><span style="color:#111">)</span>
<span style="color:#111">maxdraw_month</span> <span style="color:#f92672">=</span> <span style="color:#111">maxdraw_month</span><span style="color:#f92672">.</span><span style="color:#111">stack</span><span style="color:#111">(</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">reset_index</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">maxdraw_month</span><span style="color:#f92672">.</span><span style="color:#111">columns</span> <span style="color:#f92672">=</span> <span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">class</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">value</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span>
<span style="color:#111">maxdraw_month</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span> <span style="color:#f92672">=</span> <span style="color:#111">pd</span><span style="color:#f92672">.</span><span style="color:#111">to_datetime</span><span style="color:#111">(</span><span style="color:#111">maxdraw_month</span><span style="color:#111">[</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">]</span><span style="color:#111">)</span><span style="color:#f92672">.</span><span style="color:#111">dt</span><span style="color:#f92672">.</span><span style="color:#111">strftime</span><span style="color:#111">(</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">%</span><span style="color:#d88200">b</span><span style="color:#d88200">&#39;</span><span style="color:#111">)</span>

<span style="color:#111">g_maxdraw</span> <span style="color:#f92672">=</span> <span style="color:#111">sns</span><span style="color:#f92672">.</span><span style="color:#111">catplot</span><span style="color:#111">(</span><span style="color:#111">x</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">month</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">y</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">value</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">hue</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">class</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">kind</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">bar</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">data</span><span style="color:#f92672">=</span><span style="color:#111">maxdraw_month</span><span style="color:#111">,</span> <span style="color:#111">legend</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
<span style="color:#111">g_maxdraw</span><span style="color:#f92672">.</span><span style="color:#111">despine</span><span style="color:#111">(</span><span style="color:#111">left</span><span style="color:#f92672">=</span><span style="color:#111">True</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">legend</span><span style="color:#111">(</span><span style="color:#111">loc</span><span style="color:#f92672">=</span><span style="color:#d88200"></span><span style="color:#d88200">&#39;</span><span style="color:#d88200">upper right</span><span style="color:#d88200">&#39;</span><span style="color:#111">,</span> <span style="color:#111">frameon</span><span style="color:#f92672">=</span><span style="color:#111">False</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">tight_layout</span><span style="color:#111">(</span><span style="color:#111">)</span>
<span style="color:#111">plt</span><span style="color:#f92672">.</span><span style="color:#111">show</span><span style="color:#111">(</span><span style="color:#111">)</span>
</code></pre></td></tr></table>
</div>
</div><p><img src="/images/twitter_sentiment/output_77_0.png" alt="picture alt"></p>
<p>From the PNL plot we drew in the last section, we could see the performance of the strategy tends to be less effective in April and May. After plotting the three ratios of our monthly data, it&rsquo;s obvious that our alpha and strategy&rsquo;s edges are dimming from April to May (Sharpe Ratio and Sortino Ratio are dropping significantly and the maximum drawdown is increasing). On the contrary, the performance of the benchmark(hold ten stocks evenly every day) is steady and decent comparing with the other two. So, <strong>if we want to better our strategy&rsquo;s performance further, we could use the benchmark strategy and just buy and hold equal position of ten stocks in April and May</strong>. Combining with what happened in the states( COVID-19, quarantine, Trump&rsquo;s false administration&hellip;), we concluded that our strategy gradually lost its edge during this period because people&rsquo;s attitudes and judgements of market are not only  based on the performance of the stocks and their rational analysis, but also on their emotions(especially rage). In this case, the sentiment analysis is not effective like before. It shows the limitation of our strategy: people are emotional creatures when unusual things happen, so investing based on people&rsquo;s attitudes towards market can be profitable but in the meantime risky.</p>
<h2 id="6-conclusion">6. Conclusion</h2>
<p>Our strategy is based on NLP analysis towards twitters of the stock markets. The performance of our strategy shows the significance of the signal; however, during special time period, this strategy could be less effective and more volatile. In order to better improve the strategy&rsquo;s performance, we could enlarge our portfolio pool, which would definitely increase the accuracy of the signal. Also, expanding the backtest period would also be effective.</p>
<hr>
<h2 id="reference"><em>Reference</em></h2>
<p>Clarence C.Y. Kwan (1998). &ldquo;A note on market-neutral portfolio selection&rdquo;. Journal of BANKING &amp; FINANCE.</p>
<p>Tushar Rao and Saket Srivastava(2013).&ldquo;Analyzing Stock Market Movements Using Twitter Sentiment Analysis&rdquo;. LINCOLN REPOSITORY.</p>
<p>Yuexin Mao, Bing Wang, Wei Wei, Benyuan Liu. &ldquo;Correlating S&amp;P 500 Stocks with Twitter Data&rdquo;. ACM Digital Library.</p>
<p>Anshul Mittal and Arpit Goel(2011). &ldquo;Stock Prediction Using Twitter Sentiment Analysis&rdquo;.</p>

      </div>


      <footer>
        


        
        
        <script src="https://utteranc.es/client.js"
  repo= "christineeeeee/christineeeeee.github.io"
  issue-term="pathname"
  theme="github-light"
  crossorigin="anonymous"
  async>
</script>
      </footer>
    </article>

    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script type="text/javascript" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/startup.js" id="MathJax-script"></script>
  <script>
    MathJax = {
      tex: {
        inlineMath: [
          ['$', '$'], ['\\(', '\\)']
        ],
        processEscapes: true,
        processEnvironments: true
      },
      options: {
        skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
      }
    };
  </script>
  </section>

      </div>

      <footer class="footer">
  <section class="container">
    
    
    
    
  </section>

</footer>

    </main>

    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-171417581-1', 'auto');
	
	ga('send', 'pageview');
}
</script>


  </body>

</html>
